# 📧 NBEmail 收件箱查看器使用指南

## 🚀 功能特点

### ✨ 新增自动刷新功能
- **每15秒自动刷新**：实时监控新邮件
- **清屏显示**：每次刷新清屏，保持界面整洁
- **时间显示**：显示当前时间和下次刷新时间
- **优雅退出**：按 Ctrl+C 随时退出自动刷新

### 🎯 多种使用模式
1. **单次查看模式**：查看一次邮件后退出
2. **交互模式**：菜单式操作，功能丰富
3. **自动刷新模式**：持续监控，实时更新

## 📖 使用方法

### 基础语法
```bash
python inbox_viewer.py <邮箱地址>.<密码> [选项]
```

### 🔧 命令行选项

| 选项 | 长选项 | 说明 |
|------|--------|------|
| `-i` | `--interactive` | 启动交互模式 |
| `-a` | `--auto-refresh` | 启动自动刷新模式 (每15秒) |
| `-p N` | `--page N` | 指定页码 |
| `-l N` | `--limit N` | 每页邮件数量 |

### 📝 使用示例

#### 1. 单次查看收件箱
```bash
python inbox_viewer.py 2014131458@qq.com.tgx123456
```

#### 2. 自动刷新模式 ⭐ 新功能
```bash
python inbox_viewer.py 2014131458@qq.com.tgx123456 -a
```
- 每15秒自动刷新邮件
- 显示实时时间
- 按 Ctrl+C 退出

#### 3. 交互模式
```bash
python inbox_viewer.py 2014131458@qq.com.tgx123456 -i
```

交互模式菜单：
```
==================================================
NBEmail 收件箱查看器 - 交互模式
==================================================
1. 查看收件箱
2. 查看所有邮件
3. 搜索邮件
4. 查看邮件详情
5. 手动刷新
6. 自动刷新模式 (每15秒) ⭐ 新功能
0. 退出
--------------------------------------------------
```

#### 4. 指定页码和数量
```bash
python inbox_viewer.py 2014131458@qq.com.tgx123456 -p 2 -l 5
```

## 🎨 界面展示

### 自动刷新模式界面
```
🔄 自动刷新模式 - 每15秒刷新
⏰ 当前时间: 2025-07-20 15:33:29
按 Ctrl+C 退出自动刷新模式
================================================================================
NBEmail 收件箱查看器 - 第 1 页
总计: 5 封邮件
================================================================================

邮件 1 (ID: 123)
日期: 2025-07-20 15:30:15
发件人: sender@example.com
收件人: recipient@example.com
主题: 重要邮件
内容预览: 这是一封重要的邮件内容...
--------------------------------------------------------------------------------

⏳ 下次刷新时间: 15:33:29 + 15秒
```

### 普通模式界面
```
================================================================================
NBEmail 收件箱查看器 - 第 1 页
总计: 5 封邮件
================================================================================

邮件 1 (ID: 123)
日期: 2025-07-20 15:30:15
发件人: sender@example.com
收件人: recipient@example.com
主题: 重要邮件
内容预览: 这是一封重要的邮件内容...
--------------------------------------------------------------------------------

✓ 收件箱查看完成
```

## 🔧 高级功能

### 自动刷新特性
- **智能清屏**：每次刷新自动清屏
- **时间显示**：显示当前时间和倒计时
- **错误恢复**：网络错误时自动重试
- **优雅退出**：Ctrl+C 安全退出

### 邮件显示特性
- **自动回退**：收件箱为空时自动查看所有邮件
- **内容预览**：显示邮件内容前200字符
- **HTML清理**：自动清理HTML标签和实体
- **编码处理**：正确处理各种字符编码

## 🚨 注意事项

### 自动刷新模式
1. **资源消耗**：持续运行会消耗网络和CPU资源
2. **网络稳定**：需要稳定的网络连接
3. **服务器负载**：频繁请求可能增加服务器负载
4. **退出方式**：使用 Ctrl+C 正常退出，避免强制关闭

### 通用注意事项
1. **账号安全**：密码直接在命令行中可见，注意安全
2. **网络连接**：确保能访问 `http://localhost:8080`
3. **服务器状态**：确保 NBEmail 服务器正在运行

## 🛠️ 故障排除

### 常见问题

#### 1. 连接失败
```
✗ 网络请求失败: Connection refused
```
**解决方案**：确保 NBEmail 服务器正在运行
```bash
cd nbemail
go run main.go
```

#### 2. 登录失败
```
✗ 登录失败: 用户名或密码错误
```
**解决方案**：检查邮箱地址和密码是否正确

#### 3. 自动刷新卡住
**解决方案**：按 Ctrl+C 退出，检查网络连接

#### 4. 编码问题
**解决方案**：确保终端支持UTF-8编码

## 📊 性能建议

### 自动刷新模式优化
- **合理间隔**：15秒间隔平衡了实时性和性能
- **限制数量**：建议每页显示10-20封邮件
- **网络优化**：在稳定网络环境下使用

### 大量邮件处理
- **分页查看**：使用 `-p` 和 `-l` 参数分页
- **搜索过滤**：在交互模式中使用搜索功能
- **定期清理**：定期清理不需要的邮件

## 🔄 更新日志

### v2.0 - 自动刷新版本
- ✅ 新增自动刷新模式 (每15秒)
- ✅ 改进界面显示和清屏功能
- ✅ 增强错误处理和恢复机制
- ✅ 优化交互模式菜单

### v1.0 - 基础版本
- ✅ 基础邮件查看功能
- ✅ 交互模式
- ✅ API 集成
- ✅ 多种显示选项

---

**💡 提示**：推荐使用自动刷新模式来实时监控重要邮件！
